{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 교통카드 빅데이터 통합정보시스템에서 정보를 가져온다\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 가져올 값은 서울, 인천, 경기도의 수단 통행량이다"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2018년 1월부터 2024년 2월까지의 데이터를 가져온다\n",
    "### 가져올 항목은 시도, 시군구, 이용자유형, 연월, 교통수단, 시간대이다"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_16762/200955567.py:5: DeprecationWarning: \n",
      "Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),\n",
      "(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)\n",
      "but was not found to be installed on your system.\n",
      "If this would cause problems for you,\n",
      "please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466\n",
      "        \n",
      "  import pandas as pd\n"
     ]
    }
   ],
   "source": [
    "from selenium import webdriver\n",
    "from selenium.webdriver.chrome.service import Service\n",
    "from selenium.webdriver.chrome.options import Options\n",
    "from selenium.webdriver.common.by import By\n",
    "import pandas as pd\n",
    "import lxml\n",
    "from bs4 import BeautifulSoup\n",
    "from selenium.webdriver.common.keys import Keys\n",
    "from selenium.webdriver.support.wait import WebDriverWait\n",
    "from selenium.webdriver.support import expected_conditions as EC\n",
    "from selenium.webdriver.common.action_chains import ActionChains\n",
    "import time\n",
    "from tqdm.notebook import tqdm\n",
    "import warnings\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import koreanize_matplotlib\n",
    "from datetime import datetime\n",
    "import re\n",
    "warnings.simplefilter(action=\"ignore\", category=FutureWarning)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "options = webdriver.ChromeOptions()\n",
    "\n",
    "url = \"https://stcis.go.kr/wps/main.do\"\n",
    "driver = webdriver.Chrome(service=Service(\"../driver/chromedriver\"))\n",
    "\n",
    "driver.get(url)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "tab_menu = driver.find_element(By.CLASS_NAME,\"tab_menu\")\n",
    "tab_menu1 = tab_menu.find_elements(By.TAG_NAME,\"li\")[0]\n",
    "put_mouse = ActionChains(driver).move_to_element(tab_menu1)\n",
    "put_mouse.perform()\n",
    "time.sleep(0.1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "go_search = driver.find_element(By.ID, \"submenu1\")\n",
    "use_search = go_search.find_elements(By.CLASS_NAME,\"sub2menu\")[0]\n",
    "purpose_move = use_search.find_elements(By.TAG_NAME,\"a\")[0]\n",
    "purpose_move.click()\n",
    "driver.implicitly_wait(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "date_tab = driver.find_element(By.ID,\"divRdoDate\")\n",
    "date_tab.find_elements(By.CLASS_NAME,\"searchDateGubun\")[1].click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [],
   "source": [
    "driver.find_element(By.ID,\"searchFromMonth\").click()\n",
    "time.sleep(0.1)\n",
    "year_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-year\")\n",
    "year_picker.click()\n",
    "year_list = year_picker.find_elements(By.TAG_NAME,\"option\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "month_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-month\")\n",
    "month_picker.click()\n",
    "month_list = month_picker.find_elements(By.TAG_NAME,\"option\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "search_zone = driver.find_element(By.ID,\"searchZoneSd\")\n",
    "search_zone.click()\n",
    "search_list = search_zone.find_elements(By.TAG_NAME,\"option\")\n",
    "search_use_list = [1,4,9]       #순서대로 서울, 인천 ,경기도\n",
    "search_list[1].click()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "zone_box = driver.find_element(By.ID,\"divSgg\")\n",
    "zone_box.find_element(By.CLASS_NAME,\"check_area\").click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "search_btn = driver.find_element(By.ID,\"btnSearch\")\n",
    "search_btn.click()\n",
    "driver.implicitly_wait(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "driver.find_elements(By.CLASS_NAME,\"btn_type03\")[0].click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [],
   "source": [
    "search_use_list = [1,4,9]       #순서대로 서울, 인천 ,경기도\n",
    "\n",
    "for i in range(len(year_list)):\n",
    "    j=0\n",
    "    while j<len(month_list):\n",
    "        tab_menu = driver.find_element(By.CLASS_NAME,\"tab_menu\")\n",
    "        tab_menu1 = tab_menu.find_elements(By.TAG_NAME,\"li\")[0]\n",
    "        put_mouse = ActionChains(driver).move_to_element(tab_menu1)\n",
    "        put_mouse.perform()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        go_search = driver.find_element(By.ID, \"submenu1\")\n",
    "        use_search = go_search.find_elements(By.CLASS_NAME,\"sub2menu\")[0]\n",
    "        purpose_move = use_search.find_elements(By.TAG_NAME,\"a\")[0]\n",
    "        purpose_move.click()\n",
    "        driver.implicitly_wait(20)\n",
    "\n",
    "        date_tab = driver.find_element(By.ID,\"divRdoDate\")\n",
    "        date_tab.find_elements(By.CLASS_NAME,\"searchDateGubun\")[1].click()\n",
    "\n",
    "        driver.find_element(By.ID,\"searchFromMonth\").click()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        year_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-year\")\n",
    "        year_picker.click()\n",
    "        year_list = year_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        year_list[i].click()\n",
    "\n",
    "        month_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-month\")\n",
    "        month_picker.click()\n",
    "        month_list = month_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        month_list[j].click()\n",
    "\n",
    "        driver.find_element(By.CLASS_NAME,\"ui-datepicker-close.ui-state-default.ui-priority-primary.ui-corner-all\").click()\n",
    "\n",
    "        search_zone = driver.find_element(By.ID,\"searchZoneSd\")\n",
    "        search_zone.click()\n",
    "        search_list = search_zone.find_elements(By.TAG_NAME,\"option\")\n",
    "        search_list[1].click()\n",
    "\n",
    "        zone_box = driver.find_element(By.ID,\"divSgg\")\n",
    "        zone_box.find_element(By.CLASS_NAME,\"check_area\").click()\n",
    "\n",
    "        search_btn = driver.find_element(By.ID,\"btnSearch\")\n",
    "        search_btn.click()\n",
    "        driver.implicitly_wait(20)\n",
    "\n",
    "        driver.find_elements(By.CLASS_NAME,\"btn_type03\")[0].click()\n",
    "\n",
    "        j+=1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 서울 데이터 따로 보관하고 인천 시작"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "search_use_list = [1,4,9]       #순서대로 서울, 인천 ,경기도\n",
    "\n",
    "for i in range(len(year_list)):\n",
    "    j=0\n",
    "    while j<len(month_list):\n",
    "        tab_menu = driver.find_element(By.CLASS_NAME,\"tab_menu\")\n",
    "        tab_menu1 = tab_menu.find_elements(By.TAG_NAME,\"li\")[0]\n",
    "        put_mouse = ActionChains(driver).move_to_element(tab_menu1)\n",
    "        put_mouse.perform()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        go_search = driver.find_element(By.ID, \"submenu1\")\n",
    "        use_search = go_search.find_elements(By.CLASS_NAME,\"sub2menu\")[0]\n",
    "        purpose_move = use_search.find_elements(By.TAG_NAME,\"a\")[0]\n",
    "        purpose_move.click()\n",
    "        driver.implicitly_wait(20)\n",
    "\n",
    "        date_tab = driver.find_element(By.ID,\"divRdoDate\")\n",
    "        date_tab.find_elements(By.CLASS_NAME,\"searchDateGubun\")[1].click()\n",
    "\n",
    "        driver.find_element(By.ID,\"searchFromMonth\").click()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        year_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-year\")\n",
    "        year_picker.click()\n",
    "        year_list = year_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        year_list[i].click()\n",
    "\n",
    "        month_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-month\")\n",
    "        month_picker.click()\n",
    "        month_list = month_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        month_list[j].click()\n",
    "\n",
    "        driver.find_element(By.CLASS_NAME,\"ui-datepicker-close.ui-state-default.ui-priority-primary.ui-corner-all\").click()\n",
    "\n",
    "        search_zone = driver.find_element(By.ID,\"searchZoneSd\")\n",
    "        search_zone.click()\n",
    "        search_list = search_zone.find_elements(By.TAG_NAME,\"option\")\n",
    "        search_list[4].click()\n",
    "\n",
    "        zone_box = driver.find_element(By.ID,\"divSgg\")\n",
    "        zone_box.find_element(By.CLASS_NAME,\"check_area\").click()\n",
    "\n",
    "        search_btn = driver.find_element(By.ID,\"btnSearch\")\n",
    "        search_btn.click()\n",
    "        driver.implicitly_wait(20)\n",
    "\n",
    "        driver.find_elements(By.CLASS_NAME,\"btn_type03\")[0].click()\n",
    "\n",
    "        j+=1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 인천도 옮기고 경기도 시작"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "search_use_list = [1,4,9]       #순서대로 서울, 인천 ,경기도\n",
    "\n",
    "for i in range(len(year_list)):\n",
    "    j=0\n",
    "    while j<len(month_list):\n",
    "        tab_menu = driver.find_element(By.CLASS_NAME,\"tab_menu\")\n",
    "        tab_menu1 = tab_menu.find_elements(By.TAG_NAME,\"li\")[0]\n",
    "        put_mouse = ActionChains(driver).move_to_element(tab_menu1)\n",
    "        put_mouse.perform()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        go_search = driver.find_element(By.ID, \"submenu1\")\n",
    "        use_search = go_search.find_elements(By.CLASS_NAME,\"sub2menu\")[0]\n",
    "        purpose_move = use_search.find_elements(By.TAG_NAME,\"a\")[0]\n",
    "        purpose_move.click()\n",
    "        driver.implicitly_wait(30)\n",
    "\n",
    "        date_tab = driver.find_element(By.ID,\"divRdoDate\")\n",
    "        date_tab.find_elements(By.CLASS_NAME,\"searchDateGubun\")[1].click()\n",
    "\n",
    "        driver.find_element(By.ID,\"searchFromMonth\").click()\n",
    "        time.sleep(0.1)\n",
    "\n",
    "        year_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-year\")\n",
    "        year_picker.click()\n",
    "        year_list = year_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        year_list[i].click()\n",
    "\n",
    "        month_picker = driver.find_element(By.CLASS_NAME,\"ui-datepicker-month\")\n",
    "        month_picker.click()\n",
    "        month_list = month_picker.find_elements(By.TAG_NAME,\"option\")\n",
    "        month_list[j].click()\n",
    "\n",
    "        driver.find_element(By.CLASS_NAME,\"ui-datepicker-close.ui-state-default.ui-priority-primary.ui-corner-all\").click()\n",
    "\n",
    "        search_zone = driver.find_element(By.ID,\"searchZoneSd\")\n",
    "        search_zone.click()\n",
    "        search_list = search_zone.find_elements(By.TAG_NAME,\"option\")\n",
    "        search_list[9].click()\n",
    "\n",
    "        zone_box = driver.find_element(By.ID,\"divSgg\")\n",
    "        zone_box.find_element(By.CLASS_NAME,\"check_area\").click()\n",
    "\n",
    "        search_btn = driver.find_element(By.ID,\"btnSearch\")\n",
    "        search_btn.click()\n",
    "        driver.implicitly_wait(30)\n",
    "\n",
    "        driver.find_elements(By.CLASS_NAME,\"btn_type03\")[0].click()\n",
    "\n",
    "        j+=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['시도코드',\n",
       " '시도',\n",
       " '시군구',\n",
       " '연월',\n",
       " '이용자유형',\n",
       " '교통수단',\n",
       " '합계 발생량',\n",
       " '합계 도착량',\n",
       " '4시 발생량',\n",
       " '4시 도착량',\n",
       " '5시 발생량',\n",
       " '5시 도착량',\n",
       " '6시 발생량',\n",
       " '6시 도착량',\n",
       " '7시 발생량',\n",
       " '7시 도착량',\n",
       " '8시 발생량',\n",
       " '8시 도착량',\n",
       " '9시 발생량',\n",
       " '9시 도착량',\n",
       " '10시 발생량',\n",
       " '10시 도착량',\n",
       " '11시 발생량',\n",
       " '11시 도착량',\n",
       " '12시 발생량',\n",
       " '12시 도착량',\n",
       " '13시 발생량',\n",
       " '13시 도착량',\n",
       " '14시 발생량',\n",
       " '14시 도착량',\n",
       " '15시 발생량',\n",
       " '15시 도착량',\n",
       " '16시 발생량',\n",
       " '16시 도착량',\n",
       " '17시 발생량',\n",
       " '17시 도착량',\n",
       " '18시 발생량',\n",
       " '18시 도착량',\n",
       " '19시 발생량',\n",
       " '19시 도착량',\n",
       " '20시 발생량',\n",
       " '20시 도착량',\n",
       " '21시 발생량',\n",
       " '21시 도착량',\n",
       " '22시 발생량',\n",
       " '22시 도착량',\n",
       " '23시 발생량',\n",
       " '23시 도착량',\n",
       " '24시 발생량',\n",
       " '24시 도착량',\n",
       " '1시 발생량',\n",
       " '1시 도착량',\n",
       " '2시 발생량',\n",
       " '2시 도착량',\n",
       " '3시 발생량',\n",
       " '3시 도착량']"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "path=\"../data/seoulsu/\"\n",
    "su_col_names = ['시도코드','시도','시군구','연월','이용자유형','교통수단','합계 발생량','합계 도착량']    #수단통행량 컬럼\n",
    "for time in range(4,25):\n",
    "    su_col_names.append(str(time)+'시 발생량')\n",
    "    su_col_names.append(str(time)+'시 도착량')\n",
    "for time in range(1,4):\n",
    "    su_col_names.append(str(time)+'시 발생량')\n",
    "    su_col_names.append(str(time)+'시 도착량')\n",
    "\n",
    "su_col_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (58).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (71).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (59).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (73).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (62).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (14).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (2).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (4).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (11).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (51).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (1).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (35).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (3).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (54).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (10).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (22).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (68).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (9).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (23).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (53).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (65).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (38).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (21).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (39).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (24).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (28).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (8).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (69).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (67).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (17).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (16).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (46).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (19).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (36).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (26).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (27).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (41).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (37).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (55).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (33).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (25).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (6).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (66).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (15).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (72).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (40).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (56).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (63).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (42).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (5).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (13).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (31).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (64).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (20).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (61).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (44).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (32).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (49).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (29).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (57).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (70).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (7).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (52).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (18).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (30).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (0).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (47).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (12).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (34).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (43).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (50).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (60).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (48).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (45).xlsx']"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from glob import glob\n",
    "file_paths = glob('/home/aa/dev_ws/git_ws/data/seoulsu/*')\n",
    "file_paths"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 정렬이 안돼있다."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (0).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (1).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (2).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (3).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (4).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (5).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (6).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (7).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (8).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (9).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (10).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (11).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (12).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (13).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (14).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (15).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (16).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (17).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (18).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (19).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (20).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (21).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (22).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (23).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (24).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (25).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (26).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (27).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (28).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (29).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (30).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (31).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (32).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (33).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (34).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (35).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (36).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (37).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (38).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (39).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (40).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (41).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (42).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (43).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (44).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (45).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (46).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (47).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (48).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (49).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (50).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (51).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (52).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (53).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (54).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (55).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (56).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (57).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (58).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (59).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (60).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (61).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (62).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (63).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (64).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (65).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (66).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (67).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (68).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (69).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (70).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (71).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (72).xlsx',\n",
       " '/home/aa/dev_ws/git_ws/data/seoulsu/이용량 지표(수단통행량)_20240321 (73).xlsx']"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "file_paths.sort(key = lambda x : int(x.split('(')[-1].split(')')[0]))\n",
    "file_paths"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>시도코드</th>\n",
       "      <th>시도</th>\n",
       "      <th>시군구</th>\n",
       "      <th>연월</th>\n",
       "      <th>이용자유형</th>\n",
       "      <th>교통수단</th>\n",
       "      <th>합계 발생량</th>\n",
       "      <th>합계 도착량</th>\n",
       "      <th>4시 발생량</th>\n",
       "      <th>4시 도착량</th>\n",
       "      <th>...</th>\n",
       "      <th>23시 발생량</th>\n",
       "      <th>23시 도착량</th>\n",
       "      <th>24시 발생량</th>\n",
       "      <th>24시 도착량</th>\n",
       "      <th>1시 발생량</th>\n",
       "      <th>1시 도착량</th>\n",
       "      <th>2시 발생량</th>\n",
       "      <th>2시 도착량</th>\n",
       "      <th>3시 발생량</th>\n",
       "      <th>3시 도착량</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>경로</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>1629740</td>\n",
       "      <td>1575091</td>\n",
       "      <td>335</td>\n",
       "      <td>12</td>\n",
       "      <td>...</td>\n",
       "      <td>5846</td>\n",
       "      <td>6772</td>\n",
       "      <td>626</td>\n",
       "      <td>1680</td>\n",
       "      <td>2</td>\n",
       "      <td>77</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>25859</td>\n",
       "      <td>26034</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>361</td>\n",
       "      <td>236</td>\n",
       "      <td>50</td>\n",
       "      <td>90</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>시내</td>\n",
       "      <td>15051</td>\n",
       "      <td>6740</td>\n",
       "      <td>116</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>214</td>\n",
       "      <td>89</td>\n",
       "      <td>132</td>\n",
       "      <td>25</td>\n",
       "      <td>37</td>\n",
       "      <td>6</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>어린이</td>\n",
       "      <td>공항버스</td>\n",
       "      <td>344</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>광역</td>\n",
       "      <td>1109</td>\n",
       "      <td>897</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>742</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>청소년</td>\n",
       "      <td>광역</td>\n",
       "      <td>1091</td>\n",
       "      <td>946</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>39</td>\n",
       "      <td>17</td>\n",
       "      <td>16</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>743</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>61858</td>\n",
       "      <td>60739</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>738</td>\n",
       "      <td>2826</td>\n",
       "      <td>97</td>\n",
       "      <td>650</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>744</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>마을</td>\n",
       "      <td>4088</td>\n",
       "      <td>4164</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>75</td>\n",
       "      <td>93</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>745</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>시내</td>\n",
       "      <td>177407</td>\n",
       "      <td>174272</td>\n",
       "      <td>131</td>\n",
       "      <td>102</td>\n",
       "      <td>...</td>\n",
       "      <td>3413</td>\n",
       "      <td>4331</td>\n",
       "      <td>1003</td>\n",
       "      <td>1491</td>\n",
       "      <td>202</td>\n",
       "      <td>319</td>\n",
       "      <td>71</td>\n",
       "      <td>124</td>\n",
       "      <td>29</td>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>746</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>좌석</td>\n",
       "      <td>43</td>\n",
       "      <td>42</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>39533 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    시도코드     시도  시군구      연월  이용자유형  교통수단   합계 발생량   합계 도착량  4시 발생량  4시 도착량  \\\n",
       "1     11  서울특별시  강남구  201801     경로  도시철도  1629740  1575091     335      12   \n",
       "2      0      0    0       0  국가유공자  도시철도    25859    26034       1       1   \n",
       "3      0      0    0       0      0    시내    15051     6740     116      10   \n",
       "4      0      0    0       0    어린이  공항버스      344        0      20       0   \n",
       "5      0      0    0       0      0    광역     1109      897       0       0   \n",
       "..   ...    ...  ...     ...    ...   ...      ...      ...     ...     ...   \n",
       "742    0      0    0       0    청소년    광역     1091      946       0       0   \n",
       "743    0      0    0       0      0  도시철도    61858    60739       6       1   \n",
       "744    0      0    0       0      0    마을     4088     4164       0       0   \n",
       "745    0      0    0       0      0    시내   177407   174272     131     102   \n",
       "746    0      0    0       0      0    좌석       43       42       0       0   \n",
       "\n",
       "     ...  23시 발생량  23시 도착량  24시 발생량  24시 도착량  1시 발생량  1시 도착량  2시 발생량  2시 도착량  \\\n",
       "1    ...     5846     6772      626     1680       2      77       0       1   \n",
       "2    ...      361      236       50       90       0       3       0       0   \n",
       "3    ...      214       89      132       25      37       6      11       9   \n",
       "4    ...        5        0        0        0       0       0       0       0   \n",
       "5    ...       13        2        5        0       0       0       0       0   \n",
       "..   ...      ...      ...      ...      ...     ...     ...     ...     ...   \n",
       "742  ...       39       17       16       12      12       7       0       0   \n",
       "743  ...      738     2826       97      650       1      25       0       0   \n",
       "744  ...       75       93        0        0       0       0       0       0   \n",
       "745  ...     3413     4331     1003     1491     202     319      71     124   \n",
       "746  ...        2        0        0        0       0       0       0       0   \n",
       "\n",
       "     3시 발생량  3시 도착량  \n",
       "1         0       0  \n",
       "2         0       0  \n",
       "3         9       1  \n",
       "4         1       0  \n",
       "5         0       0  \n",
       "..      ...     ...  \n",
       "742       0       0  \n",
       "743       0       0  \n",
       "744       0       0  \n",
       "745      29      51  \n",
       "746       0       0  \n",
       "\n",
       "[39533 rows x 56 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "seoul_data = []\n",
    "\n",
    "for each_file in file_paths:\n",
    "    seoul_one_data = pd.read_excel(each_file,header=1,names=su_col_names)   #서울 데이터 불러오기\n",
    "    seoul_one_data.drop(seoul_one_data.index[0], inplace=True)              #합계 인덱스 제거\n",
    "    seoul_data.append(seoul_one_data)\n",
    "\n",
    "seoul_data = pd.concat(seoul_data)\n",
    "seoul_data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 인천 가져오기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "file_paths = glob('/home/aa/dev_ws/git_ws/data/incheonsu/*')\n",
    "file_paths.sort(key = lambda x : int(x.split('(')[-1].split(')')[0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>시도코드</th>\n",
       "      <th>시도</th>\n",
       "      <th>시군구</th>\n",
       "      <th>연월</th>\n",
       "      <th>이용자유형</th>\n",
       "      <th>교통수단</th>\n",
       "      <th>합계 발생량</th>\n",
       "      <th>합계 도착량</th>\n",
       "      <th>4시 발생량</th>\n",
       "      <th>4시 도착량</th>\n",
       "      <th>...</th>\n",
       "      <th>23시 발생량</th>\n",
       "      <th>23시 도착량</th>\n",
       "      <th>24시 발생량</th>\n",
       "      <th>24시 도착량</th>\n",
       "      <th>1시 발생량</th>\n",
       "      <th>1시 도착량</th>\n",
       "      <th>2시 발생량</th>\n",
       "      <th>2시 도착량</th>\n",
       "      <th>3시 발생량</th>\n",
       "      <th>3시 도착량</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>28</td>\n",
       "      <td>인천광역시</td>\n",
       "      <td>강화군</td>\n",
       "      <td>201801</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>시내</td>\n",
       "      <td>848</td>\n",
       "      <td>415</td>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>어린이</td>\n",
       "      <td>광역</td>\n",
       "      <td>28</td>\n",
       "      <td>42</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>마을</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>시내</td>\n",
       "      <td>1432</td>\n",
       "      <td>1380</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>좌석</td>\n",
       "      <td>31</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  시도코드     시도  시군구      연월  이용자유형 교통수단  합계 발생량  합계 도착량  4시 발생량  4시 도착량  ...  \\\n",
       "1   28  인천광역시  강화군  201801  국가유공자   시내     848     415      14       0  ...   \n",
       "2    0      0    0       0    어린이   광역      28      42       0       0  ...   \n",
       "3    0      0    0       0      0   마을       6       4       0       0  ...   \n",
       "4    0      0    0       0      0   시내    1432    1380       0       0  ...   \n",
       "5    0      0    0       0      0   좌석      31      10       0       0  ...   \n",
       "\n",
       "   23시 발생량  23시 도착량  24시 발생량  24시 도착량  1시 발생량  1시 도착량  2시 발생량  2시 도착량  3시 발생량  \\\n",
       "1        0        0        0        0       0       0       0       0       0   \n",
       "2        0        0        0        0       0       0       0       0       0   \n",
       "3        0        0        0        0       0       0       0       0       0   \n",
       "4        0        1        0        0       0       0       0       0       0   \n",
       "5        0        0        0        0       0       0       0       0       0   \n",
       "\n",
       "   3시 도착량  \n",
       "1       0  \n",
       "2       0  \n",
       "3       0  \n",
       "4       0  \n",
       "5       0  \n",
       "\n",
       "[5 rows x 56 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "incheon_data = []\n",
    "\n",
    "for each_file in file_paths:\n",
    "    incheon_one_data = pd.read_excel(each_file,header=1,names=su_col_names)   #인천 데이터 불러오기\n",
    "    incheon_one_data.drop(incheon_one_data.index[0], inplace=True)              #합계 인덱스 제거\n",
    "    incheon_data.append(incheon_one_data)\n",
    "\n",
    "incheon_data = pd.concat(incheon_data)\n",
    "incheon_data.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 경기도 가져오기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "file_paths = glob('/home/aa/dev_ws/git_ws/data/gyunggisu/*')\n",
    "file_paths.sort(key = lambda x : int(x.split('(')[-1].split(')')[0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>시도코드</th>\n",
       "      <th>시도</th>\n",
       "      <th>시군구</th>\n",
       "      <th>연월</th>\n",
       "      <th>이용자유형</th>\n",
       "      <th>교통수단</th>\n",
       "      <th>합계 발생량</th>\n",
       "      <th>합계 도착량</th>\n",
       "      <th>4시 발생량</th>\n",
       "      <th>4시 도착량</th>\n",
       "      <th>...</th>\n",
       "      <th>23시 발생량</th>\n",
       "      <th>23시 도착량</th>\n",
       "      <th>24시 발생량</th>\n",
       "      <th>24시 도착량</th>\n",
       "      <th>1시 발생량</th>\n",
       "      <th>1시 도착량</th>\n",
       "      <th>2시 발생량</th>\n",
       "      <th>2시 도착량</th>\n",
       "      <th>3시 발생량</th>\n",
       "      <th>3시 도착량</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>가평군</td>\n",
       "      <td>201801</td>\n",
       "      <td>경로</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>25027</td>\n",
       "      <td>23993</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>101</td>\n",
       "      <td>228</td>\n",
       "      <td>1</td>\n",
       "      <td>77</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>378</td>\n",
       "      <td>367</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>시내</td>\n",
       "      <td>14</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>어린이</td>\n",
       "      <td>광역</td>\n",
       "      <td>196</td>\n",
       "      <td>215</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>1925</td>\n",
       "      <td>1832</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  시도코드   시도  시군구      연월  이용자유형  교통수단  합계 발생량  합계 도착량  4시 발생량  4시 도착량  ...  \\\n",
       "1   41  경기도  가평군  201801     경로  도시철도   25027   23993       5       2  ...   \n",
       "2    0    0    0       0  국가유공자  도시철도     378     367       0       0  ...   \n",
       "3    0    0    0       0      0    시내      14      11       0       0  ...   \n",
       "4    0    0    0       0    어린이    광역     196     215       0       0  ...   \n",
       "5    0    0    0       0      0  도시철도    1925    1832       0       0  ...   \n",
       "\n",
       "   23시 발생량  23시 도착량  24시 발생량  24시 도착량  1시 발생량  1시 도착량  2시 발생량  2시 도착량  3시 발생량  \\\n",
       "1      101      228        1       77       0       0       0       0       0   \n",
       "2        1       12        0        0       0       0       0       0       0   \n",
       "3        0        0        0        0       0       0       0       0       0   \n",
       "4        0        1        0        0       0       1       0       0       0   \n",
       "5        2       12        0        0       0       0       0       0       0   \n",
       "\n",
       "   3시 도착량  \n",
       "1       0  \n",
       "2       0  \n",
       "3       0  \n",
       "4       0  \n",
       "5       0  \n",
       "\n",
       "[5 rows x 56 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gyunggi_data = []\n",
    "\n",
    "for each_file in file_paths:\n",
    "    gyunggi_one_data = pd.read_excel(each_file,header=1,names=su_col_names)   #인천 데이터 불러오기\n",
    "    gyunggi_one_data.drop(gyunggi_one_data.index[0], inplace=True)              #합계 인덱스 제거\n",
    "    gyunggi_data.append(gyunggi_one_data)\n",
    "\n",
    "gyunggi_data = pd.concat(gyunggi_data)\n",
    "gyunggi_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['서울특별시', 0, '인천광역시', '경기도'], dtype=object)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_data = pd.concat([seoul_data,incheon_data,gyunggi_data])\n",
    "all_data[\"시도\"].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 시도코드, 시도, 시군구, 연월, 이용자유형에서 0 제거"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_19107/370571128.py:3: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.\n",
      "  all_data[change_list] = all_data[change_list].fillna(method='ffill')\n",
      "/tmp/ipykernel_19107/370571128.py:3: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`\n",
      "  all_data[change_list] = all_data[change_list].fillna(method='ffill')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>시도코드</th>\n",
       "      <th>시도</th>\n",
       "      <th>시군구</th>\n",
       "      <th>연월</th>\n",
       "      <th>이용자유형</th>\n",
       "      <th>교통수단</th>\n",
       "      <th>합계 발생량</th>\n",
       "      <th>합계 도착량</th>\n",
       "      <th>4시 발생량</th>\n",
       "      <th>4시 도착량</th>\n",
       "      <th>...</th>\n",
       "      <th>23시 발생량</th>\n",
       "      <th>23시 도착량</th>\n",
       "      <th>24시 발생량</th>\n",
       "      <th>24시 도착량</th>\n",
       "      <th>1시 발생량</th>\n",
       "      <th>1시 도착량</th>\n",
       "      <th>2시 발생량</th>\n",
       "      <th>2시 도착량</th>\n",
       "      <th>3시 발생량</th>\n",
       "      <th>3시 도착량</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>경로</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>1629740</td>\n",
       "      <td>1575091</td>\n",
       "      <td>335</td>\n",
       "      <td>12</td>\n",
       "      <td>...</td>\n",
       "      <td>5846</td>\n",
       "      <td>6772</td>\n",
       "      <td>626</td>\n",
       "      <td>1680</td>\n",
       "      <td>2</td>\n",
       "      <td>77</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>25859</td>\n",
       "      <td>26034</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>361</td>\n",
       "      <td>236</td>\n",
       "      <td>50</td>\n",
       "      <td>90</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>시내</td>\n",
       "      <td>15051</td>\n",
       "      <td>6740</td>\n",
       "      <td>116</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>214</td>\n",
       "      <td>89</td>\n",
       "      <td>132</td>\n",
       "      <td>25</td>\n",
       "      <td>37</td>\n",
       "      <td>6</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>어린이</td>\n",
       "      <td>공항버스</td>\n",
       "      <td>344</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>어린이</td>\n",
       "      <td>광역</td>\n",
       "      <td>1109</td>\n",
       "      <td>897</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>867</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>광역</td>\n",
       "      <td>40485</td>\n",
       "      <td>39267</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>507</td>\n",
       "      <td>3814</td>\n",
       "      <td>254</td>\n",
       "      <td>1207</td>\n",
       "      <td>28</td>\n",
       "      <td>148</td>\n",
       "      <td>3</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>19040</td>\n",
       "      <td>19512</td>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>102</td>\n",
       "      <td>934</td>\n",
       "      <td>2</td>\n",
       "      <td>237</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>869</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>마을</td>\n",
       "      <td>152574</td>\n",
       "      <td>150192</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>899</td>\n",
       "      <td>1148</td>\n",
       "      <td>492</td>\n",
       "      <td>572</td>\n",
       "      <td>242</td>\n",
       "      <td>251</td>\n",
       "      <td>130</td>\n",
       "      <td>159</td>\n",
       "      <td>14</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>870</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>시내</td>\n",
       "      <td>213373</td>\n",
       "      <td>209477</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>3924</td>\n",
       "      <td>6357</td>\n",
       "      <td>684</td>\n",
       "      <td>1246</td>\n",
       "      <td>64</td>\n",
       "      <td>121</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>871</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>좌석</td>\n",
       "      <td>3263</td>\n",
       "      <td>3022</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>18</td>\n",
       "      <td>120</td>\n",
       "      <td>3</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>99086 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     시도코드     시도  시군구      연월  이용자유형  교통수단   합계 발생량   합계 도착량  4시 발생량  4시 도착량  \\\n",
       "1      11  서울특별시  강남구  201801     경로  도시철도  1629740  1575091     335      12   \n",
       "2      11  서울특별시  강남구  201801  국가유공자  도시철도    25859    26034       1       1   \n",
       "3      11  서울특별시  강남구  201801  국가유공자    시내    15051     6740     116      10   \n",
       "4      11  서울특별시  강남구  201801    어린이  공항버스      344        0      20       0   \n",
       "5      11  서울특별시  강남구  201801    어린이    광역     1109      897       0       0   \n",
       "..    ...    ...  ...     ...    ...   ...      ...      ...     ...     ...   \n",
       "867    41    경기도  화성시  202402    청소년    광역    40485    39267      10       0   \n",
       "868    41    경기도  화성시  202402    청소년  도시철도    19040    19512      18       0   \n",
       "869    41    경기도  화성시  202402    청소년    마을   152574   150192       0       0   \n",
       "870    41    경기도  화성시  202402    청소년    시내   213373   209477      15       5   \n",
       "871    41    경기도  화성시  202402    청소년    좌석     3263     3022       0       0   \n",
       "\n",
       "     ...  23시 발생량  23시 도착량  24시 발생량  24시 도착량  1시 발생량  1시 도착량  2시 발생량  2시 도착량  \\\n",
       "1    ...     5846     6772      626     1680       2      77       0       1   \n",
       "2    ...      361      236       50       90       0       3       0       0   \n",
       "3    ...      214       89      132       25      37       6      11       9   \n",
       "4    ...        5        0        0        0       0       0       0       0   \n",
       "5    ...       13        2        5        0       0       0       0       0   \n",
       "..   ...      ...      ...      ...      ...     ...     ...     ...     ...   \n",
       "867  ...      507     3814      254     1207      28     148       3      15   \n",
       "868  ...      102      934        2      237       0       0       0       0   \n",
       "869  ...      899     1148      492      572     242     251     130     159   \n",
       "870  ...     3924     6357      684     1246      64     121       0       7   \n",
       "871  ...       18      120        3        6       0       0       0       0   \n",
       "\n",
       "     3시 발생량  3시 도착량  \n",
       "1         0       0  \n",
       "2         0       0  \n",
       "3         9       1  \n",
       "4         1       0  \n",
       "5         0       0  \n",
       "..      ...     ...  \n",
       "867       0       0  \n",
       "868       0       0  \n",
       "869      14      25  \n",
       "870       0       0  \n",
       "871       0       0  \n",
       "\n",
       "[99086 rows x 56 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change_list = ['시도코드','시도','시군구','연월','이용자유형','교통수단']\n",
    "all_data[change_list] = all_data[change_list].replace(0,pd.NA)\n",
    "all_data[change_list] = all_data[change_list].fillna(method='ffill')\n",
    "all_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>시도코드</th>\n",
       "      <th>시도</th>\n",
       "      <th>시군구</th>\n",
       "      <th>연월</th>\n",
       "      <th>이용자유형</th>\n",
       "      <th>교통수단</th>\n",
       "      <th>합계 발생량</th>\n",
       "      <th>합계 도착량</th>\n",
       "      <th>4시 발생량</th>\n",
       "      <th>4시 도착량</th>\n",
       "      <th>...</th>\n",
       "      <th>23시 발생량</th>\n",
       "      <th>23시 도착량</th>\n",
       "      <th>24시 발생량</th>\n",
       "      <th>24시 도착량</th>\n",
       "      <th>1시 발생량</th>\n",
       "      <th>1시 도착량</th>\n",
       "      <th>2시 발생량</th>\n",
       "      <th>2시 도착량</th>\n",
       "      <th>3시 발생량</th>\n",
       "      <th>3시 도착량</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>경로</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>1629740</td>\n",
       "      <td>1575091</td>\n",
       "      <td>335</td>\n",
       "      <td>12</td>\n",
       "      <td>...</td>\n",
       "      <td>5846</td>\n",
       "      <td>6772</td>\n",
       "      <td>626</td>\n",
       "      <td>1680</td>\n",
       "      <td>2</td>\n",
       "      <td>77</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>25859</td>\n",
       "      <td>26034</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>361</td>\n",
       "      <td>236</td>\n",
       "      <td>50</td>\n",
       "      <td>90</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>국가유공자</td>\n",
       "      <td>시내</td>\n",
       "      <td>15051</td>\n",
       "      <td>6740</td>\n",
       "      <td>116</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>214</td>\n",
       "      <td>89</td>\n",
       "      <td>132</td>\n",
       "      <td>25</td>\n",
       "      <td>37</td>\n",
       "      <td>6</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>어린이</td>\n",
       "      <td>공항버스</td>\n",
       "      <td>344</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>11</td>\n",
       "      <td>서울특별시</td>\n",
       "      <td>강남구</td>\n",
       "      <td>201801</td>\n",
       "      <td>어린이</td>\n",
       "      <td>광역</td>\n",
       "      <td>1109</td>\n",
       "      <td>897</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99081</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>광역</td>\n",
       "      <td>40485</td>\n",
       "      <td>39267</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>507</td>\n",
       "      <td>3814</td>\n",
       "      <td>254</td>\n",
       "      <td>1207</td>\n",
       "      <td>28</td>\n",
       "      <td>148</td>\n",
       "      <td>3</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99082</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>도시철도</td>\n",
       "      <td>19040</td>\n",
       "      <td>19512</td>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>102</td>\n",
       "      <td>934</td>\n",
       "      <td>2</td>\n",
       "      <td>237</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99083</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>마을</td>\n",
       "      <td>152574</td>\n",
       "      <td>150192</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>899</td>\n",
       "      <td>1148</td>\n",
       "      <td>492</td>\n",
       "      <td>572</td>\n",
       "      <td>242</td>\n",
       "      <td>251</td>\n",
       "      <td>130</td>\n",
       "      <td>159</td>\n",
       "      <td>14</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99084</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>시내</td>\n",
       "      <td>213373</td>\n",
       "      <td>209477</td>\n",
       "      <td>15</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>3924</td>\n",
       "      <td>6357</td>\n",
       "      <td>684</td>\n",
       "      <td>1246</td>\n",
       "      <td>64</td>\n",
       "      <td>121</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99085</th>\n",
       "      <td>41</td>\n",
       "      <td>경기도</td>\n",
       "      <td>화성시</td>\n",
       "      <td>202402</td>\n",
       "      <td>청소년</td>\n",
       "      <td>좌석</td>\n",
       "      <td>3263</td>\n",
       "      <td>3022</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>18</td>\n",
       "      <td>120</td>\n",
       "      <td>3</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>99086 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       시도코드     시도  시군구      연월  이용자유형  교통수단   합계 발생량   합계 도착량  4시 발생량  \\\n",
       "0        11  서울특별시  강남구  201801     경로  도시철도  1629740  1575091     335   \n",
       "1        11  서울특별시  강남구  201801  국가유공자  도시철도    25859    26034       1   \n",
       "2        11  서울특별시  강남구  201801  국가유공자    시내    15051     6740     116   \n",
       "3        11  서울특별시  강남구  201801    어린이  공항버스      344        0      20   \n",
       "4        11  서울특별시  강남구  201801    어린이    광역     1109      897       0   \n",
       "...     ...    ...  ...     ...    ...   ...      ...      ...     ...   \n",
       "99081    41    경기도  화성시  202402    청소년    광역    40485    39267      10   \n",
       "99082    41    경기도  화성시  202402    청소년  도시철도    19040    19512      18   \n",
       "99083    41    경기도  화성시  202402    청소년    마을   152574   150192       0   \n",
       "99084    41    경기도  화성시  202402    청소년    시내   213373   209477      15   \n",
       "99085    41    경기도  화성시  202402    청소년    좌석     3263     3022       0   \n",
       "\n",
       "       4시 도착량  ...  23시 발생량  23시 도착량  24시 발생량  24시 도착량  1시 발생량  1시 도착량  \\\n",
       "0          12  ...     5846     6772      626     1680       2      77   \n",
       "1           1  ...      361      236       50       90       0       3   \n",
       "2          10  ...      214       89      132       25      37       6   \n",
       "3           0  ...        5        0        0        0       0       0   \n",
       "4           0  ...       13        2        5        0       0       0   \n",
       "...       ...  ...      ...      ...      ...      ...     ...     ...   \n",
       "99081       0  ...      507     3814      254     1207      28     148   \n",
       "99082       0  ...      102      934        2      237       0       0   \n",
       "99083       0  ...      899     1148      492      572     242     251   \n",
       "99084       5  ...     3924     6357      684     1246      64     121   \n",
       "99085       0  ...       18      120        3        6       0       0   \n",
       "\n",
       "       2시 발생량  2시 도착량  3시 발생량  3시 도착량  \n",
       "0           0       1       0       0  \n",
       "1           0       0       0       0  \n",
       "2          11       9       9       1  \n",
       "3           0       0       1       0  \n",
       "4           0       0       0       0  \n",
       "...       ...     ...     ...     ...  \n",
       "99081       3      15       0       0  \n",
       "99082       0       0       0       0  \n",
       "99083     130     159      14      25  \n",
       "99084       0       7       0       0  \n",
       "99085       0       0       0       0  \n",
       "\n",
       "[99086 rows x 56 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_data.reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## sql로 데이터베이스에 옮기기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "import mysql.connector\n",
    "\n",
    "conn = mysql.connector.connect(\n",
    "    host = \"database-1.c3ieyo8m4v9o.ap-northeast-2.rds.amazonaws.com\",\n",
    "    port = 3306,\n",
    "    user = \"eda_team\",\n",
    "    password = \"123456\",\n",
    "    database = \"eda_project\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "cursor = conn.cursor()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### sql에선 컬럼 이름에 띄어쓰기를 하면 안되므로 띄어쓰기가 안된 컬럼을 새로 만들어준다"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "su_col_names = ['시도코드','시도','시군구','연월','이용자유형','교통수단','합계발생량','합계도착량']    #수단통행량 컬럼\n",
    "for time in range(4,25):\n",
    "    su_col_names.append(str(time)+'시발생량')\n",
    "    su_col_names.append(str(time)+'시도착량')\n",
    "for time in range(1,4):\n",
    "    su_col_names.append(str(time)+'시발생량')\n",
    "    su_col_names.append(str(time)+'시도착량')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 데이터베이스에 테이블 만들기"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'create table method_traffic (시도코드 int, 시도 varchar(16), 시군구 varchar(16), 연월 int, 이용자유형 varchar(16), 교통수단 varchar(16), 합계발생량 int, 합계도착량 int, 4시발생량 int, 4시도착량 int, 5시발생량 int, 5시도착량 int, 6시발생량 int, 6시도착량 int, 7시발생량 int, 7시도착량 int, 8시발생량 int, 8시도착량 int, 9시발생량 int, 9시도착량 int, 10시발생량 int, 10시도착량 int, 11시발생량 int, 11시도착량 int, 12시발생량 int, 12시도착량 int, 13시발생량 int, 13시도착량 int, 14시발생량 int, 14시도착량 int, 15시발생량 int, 15시도착량 int, 16시발생량 int, 16시도착량 int, 17시발생량 int, 17시도착량 int, 18시발생량 int, 18시도착량 int, 19시발생량 int, 19시도착량 int, 20시발생량 int, 20시도착량 int, 21시발생량 int, 21시도착량 int, 22시발생량 int, 22시도착량 int, 23시발생량 int, 23시도착량 int, 24시발생량 int, 24시도착량 int, 1시발생량 int, 1시도착량 int, 2시발생량 int, 2시도착량 int, 3시발생량 int, 3시도착량 int);'"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sql=\"create table method_traffic (시도코드 int, 시도 varchar(16), 시군구 varchar(16), 연월 int, 이용자유형 varchar(16), 교통수단 varchar(16), 합계발생량 int, 합계도착량 int\"\n",
    "for column in su_col_names[8:]:\n",
    "    sql = sql + ', ' + column + ' int'\n",
    "sql=sql + ');'\n",
    "sql"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [],
   "source": [
    "cursor.execute(sql)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 99086/99086 [09:39<00:00, 171.01it/s]\n"
     ]
    }
   ],
   "source": [
    "from tqdm import tqdm\n",
    "sql = \"INSERT INTO method_traffic VALUES\"\n",
    "for i, row in tqdm(all_data.iterrows(), total = all_data.shape[0]):\n",
    "    cursor.execute(sql+str(tuple(row)))\n",
    "conn.commit()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "cursor.close()\n",
    "conn.close()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "eda_venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
